import{i as E,a as T,b as q}from"./vendor-editor-zpcSff2F.js";import{y as M,a_ as S,w as V,aL as $,r as h,Z as N,J as b,ae as o,aj as n,H as e,Q as s,a$ as O,b0 as F,b1 as P,b2 as z,b3 as D,b4 as Q,b5 as X,b6 as W,I as v,b7 as Z,b8 as J,b9 as K,ba as Y,bb as G,bc as ee}from"./vendor-core-CH6ggemF.js";const te={class:"rounded-xl border border-border bg-muted/50 transition-all focus-within:border-primary focus-within:bg-background focus-within:ring-2 focus-within:ring-primary/20"},oe={class:"flex flex-wrap items-center gap-2 border-b border-border bg-muted/30 p-2"},re={class:"relative"},ae=["disabled","title","aria-label"],ne=["disabled"],se=["disabled"],ie={class:"max-h-[600px] min-h-[200px] overflow-y-auto"},ue=M({__name:"RichTextEditor",props:{modelValue:{},placeholder:{},rows:{}},emits:["update:modelValue"],setup(y,{emit:x}){const d=y,w=x,t=S({content:d.modelValue,extensions:[E.configure({heading:{levels:[1,2,3]}}),T.configure({HTMLAttributes:{class:"my-4 rounded-xl shadow-md"}}),q.configure({placeholder:d.placeholder||"Start typing..."})],editorProps:{attributes:{class:"prose prose-sm sm:prose-base lg:prose-lg xl:prose-2xl focus:outline-none p-4",style:`min-height: ${d.rows?d.rows*24:200}px;`}},onUpdate:({editor:a})=>{w("update:modelValue",a.getHTML())}});V(()=>d.modelValue,a=>{t.value?.getHTML()===a||t.value?.commands.setContent(a||"")}),$(()=>{t.value?.destroy()});const k=()=>{t.value?.chain().focus().toggleBold().run()},C=()=>{t.value?.chain().focus().toggleItalic().run()},f=a=>{t.value?.chain().focus().toggleHeading({level:a}).run()},I=()=>{t.value?.chain().focus().toggleBulletList().run()},L=()=>{t.value?.chain().focus().toggleOrderedList().run()},B=()=>{t.value?.chain().focus().toggleBlockquote().run()},c=h(null),l=h(!1),H=()=>{c.value?.click()},U=async a=>{const r=a.target.files?.[0];if(r){if(!r.type.startsWith("image/")){alert("Please select an image file");return}if(r.size>5*1024*1024){alert("Image size must be less than 5MB");return}l.value=!0;try{const i=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");if(!i)throw new Error("CSRF token not found");const g=new FormData;g.append("image",r);const m=await fetch(route("admin.media.upload-image"),{method:"POST",headers:{"X-CSRF-TOKEN":i,"X-Requested-With":"XMLHttpRequest"},credentials:"include",body:g});if(!m.ok){let u="Upload failed";try{const p=await m.json();u=p.message||p.error||u}catch{u=m.statusText||u}throw new Error(u)}const A=await m.json();t.value?.chain().focus().setImage({src:A.url}).run(),c.value&&(c.value.value="")}catch(i){console.error("Image upload error:",i);const g=i instanceof Error?i.message:"Failed to upload image. Please try again.";alert(g)}finally{l.value=!1}}},j=()=>{const a=window.prompt("Enter image URL (https://...)");a&&t.value?.chain().focus().setImage({src:a}).run()},_=()=>{t.value?.chain().focus().undo().run()},R=()=>{t.value?.chain().focus().redo().run()};return(a,r)=>(b(),N("div",te,[o("div",oe,[o("button",{type:"button",onClick:k,class:n(["flex h-8 w-8 items-center justify-center rounded transition-colors",e(t)?.isActive("bold")?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-muted hover:text-foreground"]),title:"Bold (Ctrl+B)","aria-label":"Bold"},[s(e(O),{class:"h-4 w-4"})],2),o("button",{type:"button",onClick:C,class:n(["flex h-8 w-8 items-center justify-center rounded transition-colors",e(t)?.isActive("italic")?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-muted hover:text-foreground"]),title:"Italic (Ctrl+I)"},[s(e(F),{class:"h-4 w-4"})],2),r[3]||(r[3]=o("div",{class:"h-6 w-px bg-border"},null,-1)),o("button",{type:"button",onClick:r[0]||(r[0]=i=>f(1)),class:n(["flex h-8 w-8 items-center justify-center rounded transition-colors",e(t)?.isActive("heading",{level:1})?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-muted hover:text-foreground"]),title:"Heading 1","aria-label":"Heading 1"},[s(e(P),{class:"h-4 w-4"})],2),o("button",{type:"button",onClick:r[1]||(r[1]=i=>f(2)),class:n(["flex h-8 w-8 items-center justify-center rounded transition-colors",e(t)?.isActive("heading",{level:2})?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-muted hover:text-foreground"]),title:"Heading 2","aria-label":"Heading 2"},[s(e(z),{class:"h-4 w-4"})],2),o("button",{type:"button",onClick:r[2]||(r[2]=i=>f(3)),class:n(["flex h-8 w-8 items-center justify-center rounded transition-colors",e(t)?.isActive("heading",{level:3})?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-muted hover:text-foreground"]),title:"Heading 3","aria-label":"Heading 3"},[s(e(D),{class:"h-4 w-4"})],2),r[4]||(r[4]=o("div",{class:"h-6 w-px bg-border"},null,-1)),o("button",{type:"button",onClick:I,class:n(["flex h-8 w-8 items-center justify-center rounded transition-colors",e(t)?.isActive("bulletList")?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-muted hover:text-foreground"]),title:"Bullet List","aria-label":"Bullet List"},[s(e(Q),{class:"h-4 w-4"})],2),o("button",{type:"button",onClick:L,class:n(["flex h-8 w-8 items-center justify-center rounded transition-colors",e(t)?.isActive("orderedList")?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-muted hover:text-foreground"]),title:"Numbered List","aria-label":"Numbered List"},[s(e(X),{class:"h-4 w-4"})],2),o("button",{type:"button",onClick:B,class:n(["flex h-8 w-8 items-center justify-center rounded transition-colors",e(t)?.isActive("blockquote")?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-muted hover:text-foreground"]),title:"Quote","aria-label":"Blockquote"},[s(e(W),{class:"h-4 w-4"})],2),o("div",re,[o("input",{ref_key:"imageInput",ref:c,type:"file",accept:"image/*",class:"hidden",onChange:U},null,544),o("button",{type:"button",onClick:H,disabled:l.value,class:n(["flex h-8 w-8 items-center justify-center rounded transition-colors",l.value?"cursor-not-allowed opacity-50":"text-muted-foreground hover:bg-muted hover:text-foreground"]),title:l.value?"Uploading...":"Upload Image","aria-label":l.value?"Uploading image...":"Upload Image"},[l.value?(b(),v(e(J),{key:1,class:"h-4 w-4 animate-spin"})):(b(),v(e(Z),{key:0,class:"h-4 w-4"}))],10,ae)]),o("button",{type:"button",onClick:j,class:n(["flex h-8 w-8 items-center justify-center rounded transition-colors","text-muted-foreground hover:bg-muted hover:text-foreground"]),title:"Insert Image by URL","aria-label":"Insert Image by URL"},[s(e(K),{class:"h-4 w-4"})]),r[5]||(r[5]=o("div",{class:"h-6 w-px bg-border"},null,-1)),o("button",{type:"button",onClick:_,disabled:!e(t)?.can().undo(),class:n(["flex h-8 w-8 items-center justify-center rounded transition-colors",e(t)?.can().undo()?"text-muted-foreground hover:bg-muted hover:text-foreground":"cursor-not-allowed opacity-50"]),title:"Undo (Ctrl+Z)","aria-label":"Undo"},[s(e(Y),{class:"h-4 w-4"})],10,ne),o("button",{type:"button",onClick:R,disabled:!e(t)?.can().redo(),class:n(["flex h-8 w-8 items-center justify-center rounded transition-colors",e(t)?.can().redo()?"text-muted-foreground hover:bg-muted hover:text-foreground":"cursor-not-allowed opacity-50"]),title:"Redo (Ctrl+Y)","aria-label":"Redo"},[s(e(G),{class:"h-4 w-4"})],10,se)]),o("div",ie,[s(e(ee),{editor:e(t)},null,8,["editor"])])]))}});export{ue as _};
