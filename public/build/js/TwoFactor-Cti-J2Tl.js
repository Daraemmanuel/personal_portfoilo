import{_ as ae,a as se}from"./Layout.vue_vue_type_script_setup_true_lang-BhPMinHR.js";import{c as w,_ as $}from"./app-CGmCbmcn.js";import{ar as J,au as P}from"./vendor-CToOQyou.js";import{y as b,Z as c,J as t,aj as x,H as e,G as C,a as B,I as m,K as l,Q as s,af as oe,aa as p,ab as T,ae as n,F as g,_ as E,r as S,bQ as G,v as re,bR as ne,R as le,a1 as ie,bS as ce,az as de,bL as z,ag as ue,n as X,bT as fe,bU as pe,bV as ve,w as me,bW as be,aP as ye,bq as _e,bt as he,B as ge,q as we,at as xe,bX as N,bY as Ce}from"./vendor-core-CH6ggemF.js";import{_ as ke}from"./InputError.vue_vue_type_script_setup_true_lang-C_h_UtUM.js";import{d as $e,a as Se,b as Fe,c as Te,_ as Re}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BoPImIDW.js";import{_ as Ae,a as Ee,b as Ve}from"./PinInputSlot.vue_vue_type_script_setup_true_lang-tFIkDPtq.js";import{_ as U}from"./Spinner.vue_vue_type_script_setup_true_lang-JvWFArcm.js";import{P as je}from"./vendor-ui-B9jtnHz4.js";import{_ as qe}from"./AppLayout.vue_vue_type_script_setup_true_lang-DnEFTYhv.js";import"./vendor-editor-zpcSff2F.js";import"./SheetContent.vue_vue_type_script_setup_true_lang-D_ptdcDd.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DjPrsa6Z.js";const De=b({__name:"Alert",props:{class:{},variant:{}},setup(o){const a=o;return(r,d)=>(t(),c("div",{"data-slot":"alert",class:x(e(w)(e(Oe)({variant:o.variant}),a.class)),role:"alert"},[C(r.$slots,"default")],2))}}),Be=b({__name:"AlertDescription",props:{class:{}},setup(o){const a=o;return(r,d)=>(t(),c("div",{"data-slot":"alert-description",class:x(e(w)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",a.class))},[C(r.$slots,"default")],2))}}),ze=b({__name:"AlertTitle",props:{class:{}},setup(o){const a=o;return(r,d)=>(t(),c("div",{"data-slot":"alert-title",class:x(e(w)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",a.class))},[C(r.$slots,"default")],2))}}),Oe=J("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}}),Me={class:"list-inside list-disc text-sm"},Y=b({__name:"AlertError",props:{errors:{},title:{default:"Something went wrong."}},setup(o){const a=o,r=B(()=>Array.from(new Set(a.errors)));return(d,u)=>(t(),m(e(De),{variant:"destructive"},{default:l(()=>[s(e(oe),{class:"size-4"}),s(e(ze),null,{default:l(()=>[p(T(o.title),1)]),_:1}),s(e(Be),null,{default:l(()=>[n("ul",Me,[(t(!0),c(g,null,E(r.value,(y,i)=>(t(),c("li",{key:i},T(y),1))),128))])]),_:1})]),_:1}))}}),Le=b({__name:"Card",props:{class:{}},setup(o){const a=o;return(r,d)=>(t(),c("div",{"data-slot":"card",class:x(e(w)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a.class))},[C(r.$slots,"default")],2))}}),Pe=b({__name:"CardContent",props:{class:{}},setup(o){const a=o;return(r,d)=>(t(),c("div",{"data-slot":"card-content",class:x(e(w)("px-6",a.class))},[C(r.$slots,"default")],2))}}),Ie=b({__name:"CardDescription",props:{class:{}},setup(o){const a=o;return(r,d)=>(t(),c("p",{"data-slot":"card-description",class:x(e(w)("text-muted-foreground text-sm",a.class))},[C(r.$slots,"default")],2))}}),Ke=b({__name:"CardHeader",props:{class:{}},setup(o){const a=o;return(r,d)=>(t(),c("div",{"data-slot":"card-header",class:x(e(w)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a.class))},[C(r.$slots,"default")],2))}}),Qe=b({__name:"CardTitle",props:{class:{}},setup(o){const a=o;return(r,d)=>(t(),c("h3",{"data-slot":"card-title",class:x(e(w)("leading-none font-semibold",a.class))},[C(r.$slots,"default")],2))}}),I=async o=>{const a=await fetch(o,{headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`Failed to fetch: ${a.status}`);return a.json()},j=S([]),R=S(null),A=S(null),D=S([]),He=B(()=>A.value!==null&&R.value!==null),K=()=>{const o=async()=>{try{const{svg:v}=await I(P("two-factor.qr-code"));A.value=v}catch{j.value.push("Failed to fetch QR code"),A.value=null}},a=async()=>{try{const{secretKey:v}=await I(P("two-factor.secret-key"));R.value=v}catch{j.value.push("Failed to fetch a setup key"),R.value=null}},r=()=>{R.value=null,A.value=null,d()},d=()=>{j.value=[]};return{qrCodeSvg:A,manualSetupKey:R,recoveryCodesList:D,errors:j,hasSetupData:He,clearSetupData:r,clearErrors:d,clearTwoFactorAuthData:()=>{r(),d(),D.value=[]},fetchQrCode:o,fetchSetupKey:a,fetchSetupData:async()=>{try{d(),await Promise.all([o(),a()])}catch{A.value=null,R.value=null}},fetchRecoveryCodes:async()=>{try{d(),D.value=await I(P("two-factor.recovery-codes"))}catch{j.value.push("Failed to fetch recovery codes"),D.value=[]}}}},Ne={class:"flex flex-col gap-3 select-none sm:flex-row sm:items-center sm:justify-between"},Ue={key:0,class:"mt-6"},We={key:1,class:"mt-3 space-y-3"},Je={key:0,class:"space-y-2"},Ge=b({__name:"TwoFactorRecoveryCodes",setup(o){const{recoveryCodesList:a,fetchRecoveryCodes:r,errors:d}=K(),u=S(!1),y=G("recoveryCodeSectionRef"),i=async()=>{!u.value&&!a.value.length&&await r(),u.value=!u.value,u.value&&(await X(),y.value?.scrollIntoView({behavior:"smooth"}))};return re(async()=>{a.value.length||await r()}),(v,_)=>(t(),m(e(Le),{class:"w-full"},{default:l(()=>[s(e(Ke),null,{default:l(()=>[s(e(Qe),{class:"flex gap-3"},{default:l(()=>[s(e(ne),{class:"size-4"}),_[0]||(_[0]=p("2FA Recovery Codes ",-1))]),_:1}),s(e(Ie),null,{default:l(()=>[..._[1]||(_[1]=[p(" Recovery codes let you regain access if you lose your 2FA device. Store them in a secure password manager. ",-1)])]),_:1})]),_:1}),s(e(Pe),null,{default:l(()=>[n("div",Ne,[s(e($),{onClick:i,class:"w-fit"},{default:l(()=>[(t(),m(ie(u.value?e(ce):e(de)),{class:"size-4"})),p(" "+T(u.value?"Hide":"View")+" Recovery Codes ",1)]),_:1}),u.value&&e(a).length?(t(),m(e(z),{key:0,action:v.route("two-factor.regenerate-recovery-codes"),method:"post",options:{preserveScroll:!0},onSuccess:e(r)},{default:l(({processing:k})=>[s(e($),{variant:"secondary",type:"submit",disabled:k},{default:l(()=>[s(e(ue)),_[2]||(_[2]=p(" Regenerate Codes ",-1))]),_:1},8,["disabled"])]),_:1},8,["action","onSuccess"])):le("",!0)]),n("div",{class:x(["relative overflow-hidden transition-all duration-300",u.value?"h-auto opacity-100":"h-0 opacity-0"])},[e(d)?.length?(t(),c("div",Ue,[s(Y,{errors:e(d)},null,8,["errors"])])):(t(),c("div",We,[n("div",{ref_key:"recoveryCodeSectionRef",ref:y,class:"grid gap-1 rounded-lg bg-muted p-4 font-mono text-sm"},[e(a).length?(t(!0),c(g,{key:1},E(e(a),(k,F)=>(t(),c("div",{key:F},T(k),1))),128)):(t(),c("div",Je,[(t(),c(g,null,E(8,k=>n("div",{key:k,class:"h-4 animate-pulse rounded bg-muted-foreground/20"})),64))]))],512),_[3]||(_[3]=n("p",{class:"text-xs text-muted-foreground select-none"},[p(" Each recovery code can be used once to access your account and will be removed after use. If you need more, click "),n("span",{class:"font-bold"},"Regenerate Codes"),p(" above. ")],-1))]))],2)]),_:1})]),_:1}))}}),Xe={class:"mb-3 w-auto rounded-full border border-border bg-card p-0.5 shadow-sm"},Ye={class:"relative overflow-hidden rounded-full border border-border bg-muted p-2.5"},Ze={class:"absolute inset-0 grid grid-cols-5 opacity-50"},et={class:"absolute inset-0 grid grid-rows-5 opacity-50"},tt={class:"relative flex w-auto flex-col items-center justify-center space-y-5"},at={class:"relative mx-auto flex max-w-md items-center overflow-hidden"},st={class:"relative mx-auto aspect-square w-64 overflow-hidden rounded-lg border border-border"},ot={key:0,class:"absolute inset-0 z-10 flex aspect-square h-auto w-full animate-pulse items-center justify-center bg-background"},rt={key:1,class:"relative z-10 overflow-hidden border p-5"},nt=["innerHTML"],lt={class:"flex w-full items-center space-x-5"},it={class:"flex w-full items-center justify-center space-x-2"},ct={class:"flex w-full items-stretch overflow-hidden rounded-xl border border-border"},dt={key:0,class:"flex h-full w-full items-center justify-center bg-muted p-3"},ut=["value"],ft=["value"],pt={class:"flex w-full flex-col items-center justify-center space-y-3 py-2"},vt={class:"flex w-full items-center space-x-5"},mt=b({__name:"TwoFactorSetupModal",props:fe({requiresConfirmation:{type:Boolean},twoFactorEnabled:{type:Boolean}},{isOpen:{type:Boolean},isOpenModifiers:{}}),emits:["update:isOpen"],setup(o){const a=o,r=pe(o,"isOpen"),{copy:d,copied:u}=ve(),{qrCodeSvg:y,manualSetupKey:i,clearSetupData:v,fetchSetupData:_,errors:k}=K(),F=S(!1),V=S([]),Q=B(()=>V.value.join("")),H=G("pinInputContainerRef"),O=B(()=>a.twoFactorEnabled?{title:"Two-Factor Authentication Enabled",description:"Two-factor authentication is now enabled. Scan the QR code or enter the setup key in your authenticator app.",buttonText:"Close"}:F.value?{title:"Verify Authentication Code",description:"Enter the 6-digit code from your authenticator app",buttonText:"Continue"}:{title:"Enable Two-Factor Authentication",description:"To finish enabling two-factor authentication, scan the QR code or enter the setup key in your authenticator app",buttonText:"Continue"}),Z=()=>{if(a.requiresConfirmation){F.value=!0,X(()=>{H.value?.querySelector("input")?.focus()});return}v(),r.value=!1},ee=()=>{a.twoFactorEnabled&&v(),F.value=!1,V.value=[]};return me(()=>r.value,async M=>{if(!M){ee();return}y.value||await _()}),(M,f)=>(t(),m(e($e),{open:r.value,"onUpdate:open":f[5]||(f[5]=h=>r.value=h)},{default:l(()=>[s(e(Re),{class:"sm:max-w-md"},{default:l(()=>[s(e(Se),{class:"flex items-center justify-center"},{default:l(()=>[n("div",Xe,[n("div",Ye,[n("div",Ze,[(t(),c(g,null,E(5,h=>n("div",{key:`col-${h}`,class:"border-r border-border last:border-r-0"})),64))]),n("div",et,[(t(),c(g,null,E(5,h=>n("div",{key:`row-${h}`,class:"border-b border-border last:border-b-0"})),64))]),s(e(be),{class:"relative z-20 size-6 text-foreground"})])]),s(e(Fe),null,{default:l(()=>[p(T(O.value.title),1)]),_:1}),s(e(Te),{class:"text-center"},{default:l(()=>[p(T(O.value.description),1)]),_:1})]),_:1}),n("div",tt,[F.value?(t(),m(e(z),{key:1,action:M.route("two-factor.confirm"),method:"post","reset-on-error":"",onFinish:f[3]||(f[3]=h=>V.value=[]),onSuccess:f[4]||(f[4]=h=>r.value=!1)},{default:l(({errors:h,processing:L})=>[n("input",{type:"hidden",name:"code",value:Q.value},null,8,ft),n("div",{ref_key:"pinInputContainerRef",ref:H,class:"relative w-full space-y-3"},[n("div",pt,[s(e(Ae),{id:"otp",placeholder:"â—‹",modelValue:V.value,"onUpdate:modelValue":f[1]||(f[1]=q=>V.value=q),type:"number",otp:""},{default:l(()=>[s(e(Ee),null,{default:l(()=>[(t(),c(g,null,E(6,(q,te)=>s(e(Ve),{autofocus:"",key:q,index:te,disabled:L},null,8,["index","disabled"])),64))]),_:2},1024)]),_:2},1032,["modelValue"]),s(ke,{message:h.code},null,8,["message"])]),n("div",vt,[s(e($),{type:"button",variant:"outline",class:"w-auto flex-1",onClick:f[2]||(f[2]=q=>F.value=!1),disabled:L},{default:l(()=>[...f[7]||(f[7]=[p(" Back ",-1)])]),_:1},8,["disabled"]),s(e($),{type:"submit",class:"w-auto flex-1",disabled:L||Q.value.length<6},{default:l(()=>[...f[8]||(f[8]=[p(" Confirm ",-1)])]),_:1},8,["disabled"])])],512)]),_:1},8,["action"])):(t(),c(g,{key:0},[e(k)?.length?(t(),m(Y,{key:0,errors:e(k)},null,8,["errors"])):(t(),c(g,{key:1},[n("div",at,[n("div",st,[e(y)?(t(),c("div",rt,[n("div",{innerHTML:e(y),class:"flex aspect-square size-full items-center justify-center"},null,8,nt)])):(t(),c("div",ot,[s(e(U),{class:"size-6"})]))])]),n("div",lt,[s(e($),{class:"w-full",onClick:Z},{default:l(()=>[p(T(O.value.buttonText),1)]),_:1})]),f[6]||(f[6]=n("div",{class:"relative flex w-full items-center justify-center"},[n("div",{class:"absolute inset-0 top-1/2 h-px w-full bg-border"}),n("span",{class:"relative bg-card px-2 py-1"},"or, enter the code manually")],-1)),n("div",it,[n("div",ct,[e(i)?(t(),c(g,{key:1},[n("input",{type:"text",readonly:"",value:e(i),class:"h-full w-full bg-background p-3 text-foreground"},null,8,ut),n("button",{onClick:f[0]||(f[0]=h=>e(d)(e(i)||"")),class:"relative block h-auto border-l border-border px-3 hover:bg-muted"},[e(u)?(t(),m(e(ye),{key:0,class:"w-4 text-green-500"})):(t(),m(e(_e),{key:1,class:"w-4"}))])],64)):(t(),c("div",dt,[s(e(U))]))])])],64))],64))])]),_:1})]),_:1},8,["open"]))}}),W=b({__name:"Badge",props:{asChild:{type:Boolean},as:{},variant:{},class:{}},setup(o){const a=o,r=he(a,"class");return(d,u)=>(t(),m(e(je),ge({"data-slot":"badge",class:e(w)(e(bt)({variant:o.variant}),a.class)},e(r)),{default:l(()=>[C(d.$slots,"default")]),_:3},16,["class"]))}}),bt=J("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}}),yt={class:"space-y-6"},_t={key:0,class:"flex flex-col items-start justify-start space-y-4"},ht={key:1,class:"flex flex-col items-start justify-start space-y-4"},gt={class:"relative inline"},qt=b({__name:"TwoFactor",props:{requiresConfirmation:{type:Boolean,default:!1},twoFactorEnabled:{type:Boolean,default:!1}},setup(o){const a=[{title:"Two-Factor Authentication",href:route("two-factor.show")}],{hasSetupData:r,clearTwoFactorAuthData:d}=K(),u=S(!1);return we(()=>{d()}),(y,i)=>(t(),m(qe,{breadcrumbs:a},{default:l(()=>[s(e(xe),{title:"Two-Factor Authentication"}),s(ae,null,{default:l(()=>[n("div",yt,[s(se,{title:"Two-Factor Authentication",description:"Manage your two-factor authentication settings"}),o.twoFactorEnabled?(t(),c("div",ht,[s(e(W),{variant:"default"},{default:l(()=>[...i[7]||(i[7]=[p("Enabled",-1)])]),_:1}),i[9]||(i[9]=n("p",{class:"text-muted-foreground"}," With two-factor authentication enabled, you will be prompted for a secure, random pin during login, which you can retrieve from the TOTP-supported application on your phone. ",-1)),s(Ge),n("div",gt,[s(e(z),{action:y.route("two-factor.disable"),method:"delete"},{default:l(({processing:v})=>[s(e($),{variant:"destructive",type:"submit",disabled:v},{default:l(()=>[s(e(Ce)),i[8]||(i[8]=p(" Disable 2FA ",-1))]),_:1},8,["disabled"])]),_:1},8,["action"])])])):(t(),c("div",_t,[s(e(W),{variant:"destructive"},{default:l(()=>[...i[3]||(i[3]=[p("Disabled",-1)])]),_:1}),i[6]||(i[6]=n("p",{class:"text-muted-foreground"}," When you enable two-factor authentication, you will be prompted for a secure pin during login. This pin can be retrieved from a TOTP-supported application on your phone. ",-1)),n("div",null,[e(r)?(t(),m(e($),{key:0,onClick:i[0]||(i[0]=v=>u.value=!0)},{default:l(()=>[s(e(N)),i[4]||(i[4]=p("Continue Setup ",-1))]),_:1})):(t(),m(e(z),{key:1,action:y.route("two-factor.enable"),method:"post",onSuccess:i[1]||(i[1]=v=>u.value=!0)},{default:l(({processing:v})=>[s(e($),{type:"submit",disabled:v},{default:l(()=>[s(e(N)),i[5]||(i[5]=p("Enable 2FA",-1))]),_:1},8,["disabled"])]),_:1},8,["action"]))])])),s(mt,{isOpen:u.value,"onUpdate:isOpen":i[2]||(i[2]=v=>u.value=v),requiresConfirmation:o.requiresConfirmation,twoFactorEnabled:o.twoFactorEnabled},null,8,["isOpen","requiresConfirmation","twoFactorEnabled"])])]),_:1})]),_:1}))}});export{qt as default};
