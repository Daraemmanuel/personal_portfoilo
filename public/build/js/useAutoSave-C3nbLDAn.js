import"./app-Be-_g2rP.js";import{r as u,w as b,aL as y}from"./vendor-core-CH6ggemF.js";function h(e,c,v={}){const{debounceMs:p=2e3,enabled:r=!0,onSave:d,onError:S}=v,a=u(!1),o=u(null);let t=null;const i=async()=>{if(!(!r||e.processing||a.value)&&!(!e.title&&!e.content)){a.value=!0;try{await new Promise((s,g)=>{const w=e.tags&&typeof e.tags=="string"?{...e.data(),tags:e.tags.split(",").map(n=>n.trim()).filter(Boolean)}:e.data();e.transform(()=>w).post(c,{preserveState:!0,preserveScroll:!0,only:["article","errors"],onSuccess:()=>{o.value=new Date,d?.(),s()},onError:n=>{S?.(n),g(n)},onFinish:()=>{a.value=!1}})})}catch(s){console.warn("Auto-save failed:",s)}}},l=()=>{t&&clearTimeout(t),t=setTimeout(()=>{i()},p)};return b(()=>[e.title,e.content,e.excerpt],()=>{r&&e.title&&l()},{deep:!0}),y(()=>{t&&clearTimeout(t)}),{isSaving:a,lastSaved:o,save:l,saveNow:i}}export{h as u};
